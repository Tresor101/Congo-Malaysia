<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Basic -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Congolese Community in Malaysia</title>
  <meta name="description" content="Congolese Community in Malaysia â€“ events, news, resources, and connections for our diaspora." />
  <meta name="theme-color" content="#0f3460" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="Congolese Community in Malaysia" />
  <meta property="og:description" content="Events, news, and connections for Congolese in Malaysia." />
  <meta property="og:image" content="images/flags.jpg" />

  <!-- Favicon -->
  <link rel="icon" type="image/jpeg" href="images/flags.jpg" />
  <link rel="apple-touch-icon" href="images/flags.jpg" />

  <!-- Styles: Bootstrap (for header/footer components) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />

  <!-- Minimal page styles -->
  <style>
    html, body { height: 100%; }
    body { display: flex; flex-direction: column; }
    main { flex: 1 0 auto; }

    /* Skip link for accessibility */
    .skip-to-content {
      position: absolute; left: -999px; top: auto; width: 1px; height: 1px; overflow: hidden;
    }
    .skip-to-content:focus {
      position: fixed; left: 1rem; top: 1rem; width: auto; height: auto; z-index: 1100;
      background: #0f3460; color: #fff; padding: .5rem .75rem; border-radius: .5rem;
      box-shadow: 0 4px 12px rgba(0,0,0,.25);
    }

    /* Scroll-to-top */
    #scroll-to-top {
      position: fixed; right: 24px; bottom: 24px; width: 50px; height: 50px;
      border: 0; border-radius: 50%; cursor: pointer; z-index: 1050;
      display: grid; place-items: center; color: #fff;
      background: linear-gradient(135deg, #007bff, #00d4ff);
      box-shadow: 0 6px 20px rgba(0,123,255,.35);
      opacity: 0; visibility: hidden; transform: translateY(12px);
      transition: all .3s ease;
    }
    #scroll-to-top.show { opacity: 1; visibility: visible; transform: translateY(0); }
    #scroll-to-top:hover { transform: translateY(-4px); }

    /* Section scaffolding (optional) */
    section.page-section { scroll-margin-top: 90px; }

    /* Loading spinner for sections */
    .section-loading {
      min-height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .spinner-border-custom {
      width: 3rem;
      height: 3rem;
      border-width: 0.3em;
    }
  </style>
</head>
<body>
  <a class="skip-to-content" href="#main-content">Skip to content</a>

  <!-- Header include -->
  <div id="header-placeholder" role="banner" aria-label="Site header"></div>

  <!-- Main -->
  <main id="main-content" tabindex="-1">
    <!-- Hero -->
    <section id="hero-section" class="page-section">
      <div class="section-loading">
        <div class="spinner-border text-primary spinner-border-custom" role="status">
          <span class="visually-hidden">Loading hero...</span>
        </div>
      </div>
    </section>

    <!-- About -->
    <section id="about-section" class="page-section">
      <div class="section-loading">
        <div class="spinner-border text-primary spinner-border-custom" role="status">
          <span class="visually-hidden">Loading about...</span>
        </div>
      </div>
    </section>

    <!-- Events -->
    <section id="events-section" class="page-section">
      <div class="section-loading">
        <div class="spinner-border text-primary spinner-border-custom" role="status">
          <span class="visually-hidden">Loading events...</span>
        </div>
      </div>
    </section>

    <!-- News -->
    <section id="news-section" class="page-section">
      <div class="section-loading">
        <div class="spinner-border text-primary spinner-border-custom" role="status">
          <span class="visually-hidden">Loading news...</span>
        </div>
      </div>
    </section>

    <!-- Gallery -->
    <section id="gallery-section" class="page-section">
      <div class="section-loading">
        <div class="spinner-border text-primary spinner-border-custom" role="status">
          <span class="visually-hidden">Loading gallery...</span>
        </div>
      </div>
    </section>

    <!-- Committee -->
    <section id="committee-section" class="page-section">
      <div class="section-loading">
        <div class="spinner-border text-primary spinner-border-custom" role="status">
          <span class="visually-hidden">Loading committee...</span>
        </div>
      </div>
    </section>
  </main>

  <!-- Footer include -->
  <div id="footer-placeholder" role="contentinfo" aria-label="Site footer"></div>

  <!-- Scroll-to-top -->
  <button id="scroll-to-top" aria-label="Scroll to top" title="Back to top">
    <svg width="22" height="22" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
      <polyline points="18 15 12 9 6 15"></polyline>
    </svg>
  </button>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" defer></script>
  <script>
    // Universal section loader
    (function() {
      const loadSection = async (url, sectionId, fallbackMsg) => {
        const mount = document.querySelector(`#${sectionId}`);
        if (!mount) return;

        try {
          const res = await fetch(url, { cache: 'no-cache' });
          if (!res.ok) throw new Error(`HTTP ${res.status}`);
          const html = await res.text();

          const wrapper = document.createElement('div');
          wrapper.innerHTML = html;

          // Move any <style> blocks from the fetched file into <head>
          wrapper.querySelectorAll('style').forEach(style => document.head.appendChild(style));

          // Use the fetched section if it has matching ID, otherwise inject raw HTML
          const fetchedSection = wrapper.querySelector(`#${sectionId}`) || wrapper.firstElementChild;
          if (fetchedSection) {
            mount.replaceWith(fetchedSection);
          } else {
            mount.innerHTML = html;
          }
        } catch (e) {
          console.error(`${url} load failed:`, e);
          mount.innerHTML = `
            <div class="container py-5">
              <p class="text-muted text-center">${fallbackMsg || 'Section is unavailable.'}</p>
            </div>
          `;
        }
      };

      const loadInto = async (url, el) => {
        try {
          const res = await fetch(url, { cache: 'no-cache' });
          if (!res.ok) throw new Error(`${res.status} ${res.statusText}`);
          el.innerHTML = await res.text();
        } catch (e) {
          console.error('Include failed:', url, e);
        }
      };

      document.addEventListener('DOMContentLoaded', async () => {
        // Load header & footer
        await Promise.all([
          loadInto('./header.html', document.getElementById('header-placeholder')),
          loadInto('./footer.html', document.getElementById('footer-placeholder')),
        ]);

        // Load all sections
        await Promise.all([
          loadSection('./hero.html', 'hero-section', 'Hero section is unavailable.'),
          loadSection('./about.html', 'about-section', 'About section is unavailable.'),
          loadSection('./events.html', 'events-section', 'Events section is unavailable.'),
          loadSection('./news.html', 'news-section', 'News section is unavailable.'),
          loadSection('./gallery.html', 'gallery-section', 'Gallery section is unavailable.'),
          loadSection('./committee.html', 'committee-section', 'Committee section is unavailable.'),
        ]);
      });

      // Scroll-to-top logic
      const btn = document.getElementById('scroll-to-top');
      const toggleBtn = () => {
        const y = window.pageYOffset || document.documentElement.scrollTop;
        btn.classList.toggle('show', y > 300);
      };
      window.addEventListener('scroll', toggleBtn, { passive: true });
      btn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
      toggleBtn();
    })();
  </script>

  <noscript>
    <div class="alert alert-warning text-center m-0" role="alert">
      JavaScript is disabled. Header/footer includes and smooth scrolling are limited.
    </div>
  </noscript>
</body>
</html>
